/* ===== RESPONSIVE CSS - ISRAEL EARTHQUAKE MAP ===== */

/* ===== DESKTOP STYLES (min-width queries) ===== */

/* Large Desktop (1024px+) */
@media (min-width: 1024px) {
    .filters-container { 
        flex-wrap: nowrap; 
        align-items: flex-end; 
    }
    .filter-group { 
        flex: 0 0 auto; 
    }
}

/* Desktop (769px+) */
@media (min-width: 769px) {
    /* Hide mobile toggles on desktop */
    .mobile-sidebar-toggle,
    .mobile-legend-toggle,
    .mobile-filters-toggle {
        display: none !important;
    }
}

/* Medium Desktop (769px - 1200px) */
@media (min-width: 769px) and (max-width: 1200px) {
    #sidebar { 
        width: 300px; 
    }
    .stat-grid { 
        grid-template-columns: 1fr; 
        gap: 10px; 
    }
}

/* ===== TABLET STYLES (768px and below) ===== */

@media (max-width: 768px) {
    /* ===== LAYOUT OVERRIDES ===== */
    #main-content { 
        flex-direction: column; 
        height: calc(100vh - 0px); 
        min-height: 0; 
    }
    #map-container { 
        flex: 1; 
        height: auto; 
        min-height: 0; 
    }
    #sidebar { 
        width: 100%; 
        border-left: none; 
        border-top: 1px solid var(--border-1); 
        max-height: 40vh; 
    }
    
    /* ===== HEADER LAYOUT ===== */
    .header-layout { 
        flex-direction: column !important; 
        gap: 5px; 
        align-items: flex-start !important; 
    }
    .title-section { 
        text-align: left; 
        width: 100%; 
        order: 1; 
        margin-bottom: 0;
    }
    .last-updated { 
        width: 100%; 
        justify-content: flex-start !important; 
        flex-wrap: wrap; 
        gap: 10px; 
        margin-left: 0 !important; 
        margin-top: 0 !important;
        order: 2; 
    }
    #filters-panel h1 { 
        font-size: 1.4rem; 
        margin-bottom: 5px; 
    }
    
    /* ===== FILTERS PANEL ===== */
    .filters-container { 
        flex-direction: column; 
        gap: 15px; 
    }
    .filter-group { 
        width: 100%; 
    }
    .container { 
        padding: 0 15px; 
    }
    .select-filter { 
        min-width: 160px; 
        font-size: 0.9rem; 
    }
    .year-group { 
        margin-left: 0; 
    }
    
    /* ===== FILTERS PANE OVERLAY ===== */
    #filters-pane.filters-container { 
        display: none !important; 
    }
    #filters-pane.filters-container.show {
        display: flex !important;
        position: absolute !important;
        top: 100% !important;
        bottom: auto !important;
        left: 0 !important;
        right: 0 !important;
        background: rgba(255,255,255,0.95) !important;
        backdrop-filter: none !important;
        border-top: 1px solid var(--glass-border) !important;
        padding: 12px 12px 6px !important;
        max-height: none !important;
        overflow-y: visible !important;
        overflow-x: hidden !important;
        z-index: 2000 !important;
        box-shadow: var(--shadow-2) !important;
        pointer-events: auto !important;
        opacity: 1 !important;
        visibility: visible !important;
        transform: translateY(0) !important;
    }
    :root[data-theme='dark'] #filters-pane.filters-container.show { 
        background: rgba(15,23,42,0.95) !important; 
    }
    
    /* ===== MOBILE TOGGLES ===== */
    .mobile-sidebar-toggle,
    .mobile-legend-toggle,
    .mobile-filters-toggle { 
        display: flex !important; 
    }
    .mobile-sidebar-toggle { 
        position: fixed; 
        bottom: 10px; 
        right: 10px; 
        top: auto; 
        padding: 8px 12px; 
        font-size: 0.75rem; 
        min-height: 40px; 
        border-radius: 20px; 
        z-index: 1002; 
    }
    .mobile-legend-toggle { 
        position: fixed; 
        bottom: 10px; 
        right: 90px; 
        top: auto; 
        padding: 8px 12px; 
        font-size: 0.75rem; 
        min-height: 40px; 
        border-radius: 20px; 
        z-index: 1002; 
    }
    .mobile-filters-toggle { 
        position: fixed; 
        bottom: 10px; 
        right: 170px; 
        top: auto; 
        padding: 8px 12px; 
        font-size: 0.75rem; 
        min-height: 40px; 
        border-radius: 20px; 
        z-index: 1002; 
    }
    
    /* ===== DESKTOP TOGGLES HIDDEN ===== */
    #header-legend-toggle,
    #header-filters-toggle,
    #header-data-toggle { 
        display: none !important; 
    }
    
    /* ===== LEGEND ===== */
    #map-legend { 
        display: none; 
    }
    #map-legend.show { 
        display: block; 
        position: fixed; 
        bottom: 10px; 
        left: 10px; 
        right: 10px; 
        z-index: 999; 
        max-height: 50vh; 
        overflow-y: auto; 
        min-width: auto; 
        padding: 12px; 
    }
    .legend-section { 
        margin-bottom: 10px; 
    }
    .legend-items { 
        display: grid; 
        grid-template-columns: repeat(2, 1fr); 
        gap: 5px; 
    }
    
    /* ===== STATISTICS ===== */
    .stat-grid { 
        grid-template-columns: 1fr 1fr; 
        gap: 10px; 
    }
    
    /* ===== TABLE ===== */
    #earthquake-table { 
        font-size: 0.8rem; 
    }
    #earthquake-table th, 
    #earthquake-table td { 
        padding: 8px 6px; 
    }
    
    /* ===== CREDITS POPUP ===== */
    .credits-popup { 
        position: fixed !important; 
        top: 50% !important; 
        left: 50% !important; 
        transform: translate(-50%, -50%) !important; 
        width: 90vw !important; 
        max-width: 320px !important; 
        z-index: 2100 !important; 
    }
    .credits-container:hover .credits-popup,
    .credits-container.open .credits-popup { 
        position: fixed !important;
        top: 50% !important; 
        left: 50% !important; 
        transform: translate(-50%, 30%) !important; 
        opacity: 1 !important; 
        visibility: visible !important; 
    }
    
    /* ===== FILTER COMPONENT OVERRIDES ===== */
    /* Filter Controls */
    .date-filter-card .collapsible { 
        min-height: 0 !important; 
    }
    .date-mode-toggle { 
        margin-bottom: 4px !important; 
    }
    .relative-options { 
        margin-top: 0px !important; 
        margin-bottom: 0px !important; 
    }
    
    /* Filter Layout */
    #filters-pane.filters-container { 
        max-height: 75vh; 
    }
    .year-group { 
        margin-left: 0 !important; 
        min-width: 100% !important; 
        max-width: 100% !important; 
        width: 100% !important; 
    }
    .year-slider-container,
    .magnitude-slider-container,
    #magnitude-range-container { 
        width: 100% !important; 
        max-width: 100% !important; 
        padding: 0 4px 16px 4px !important; 
        box-sizing: border-box; 
    }
    #year-range-slider,
    #magnitude-range-slider { 
        width: 100% !important; 
        max-width: 100% !important; 
        box-sizing: border-box; 
    }
    #filters-pane.filters-container > .filter-group:first-of-type,
    #filters-pane.filters-container > .filter-group { 
        flex: 1 1 100% !important; 
        min-width: 100% !important; 
        max-width: 100% !important; 
        width: 100% !important; 
    }
    #filters-pane.filters-container > .filter-group:nth-of-type(2),
    #filters-pane.filters-container > .filter-group:nth-of-type(3) { 
        flex: 0 0 0px; 
        margin-left: 0px; 
    }
    
    /* Filter Sliders */
    #year-range-slider .noUi-pips,
    #magnitude-range-slider .noUi-pips { 
        width: 100% !important; 
        transform: none !important; 
    }
}

/* ===== SMALL MOBILE STYLES (480px and below) ===== */

@media (max-width: 480px) {
    /* ===== LAYOUT ===== */
    .container { 
        padding: 0 10px; 
    }
    #filters-panel > .container { 
        padding-left: 10px !important; 
        padding-right: 10px !important; 
    }
    #main-content { 
        flex-direction: column !important; 
        height: calc(100vh - 0px) !important; 
        min-height: 0 !important; 
    }
    
    /* ===== HEADER ===== */
    header { 
        padding: 6px 0 !important; 
        min-height: 56px !important; 
    }
    .header-layout { 
        flex-direction: column !important; 
        align-items: flex-start !important; 
        gap: 3px !important; 
    }
    .title-section { 
        order: 1 !important; 
        padding: 0px 0px 0 0px !important; 
        text-align: left !important; 
        width: 100% !important; 
    }
    .title-section h1 { 
        font-size: 1.1rem !important; 
        margin: 0 !important; 
        line-height: 1.2 !important; 
    }
    #filters-panel h1 { 
        font-size: 1.1rem; 
        margin-bottom: 6px; 
    }
    .header-actions { 
        position: absolute !important; 
        top: 14px !important; 
        right: 0px !important; 
        margin: 0 !important; 
        order: 3 !important; 
        z-index: 1001 !important; 
    }
    .last-updated { 
        font-size: 0.6rem !important; 
        margin-top: 1px !important; 
        gap: 6px; 
    }
    .credits-trigger { 
        font-size: 0.55rem !important; 
        padding: 3px; 
    }
    
    /* ===== FILTERS ===== */
    .filters-container { 
        gap: 8px; 
    }
    .filter-group { 
        width: 100%; 
        margin-bottom: 0; 
    }
    .select-filter { 
        width: 100%; 
        min-width: 0; 
        font-size: 1rem; 
        padding: 10px 12px; 
    }
    .year-group { 
        width: 100%; 
    }
    #filters-pane.filters-container { 
        display: none !important; 
    }
    #filters-pane.filters-container.show { 
        display: flex !important; 
    }
    #filters-pane { 
        overflow-y: auto !important; 
    }
    
    /* ===== BASEMAP TOGGLE ===== */
    .header-actions sl-switch#basemap-toggle::part(base) { 
        --width: 54px; 
    }
    sl-switch#basemap-toggle::part(control) { 
        height: 26px; 
    }
    sl-switch#basemap-toggle::part(thumb) { 
        width: 26px; 
        height: 26px; 
        background-position: 50% 50% !important; 
    }
    sl-switch#basemap-toggle::part(control) {
        background-image:
            linear-gradient(180deg, rgba(255,255,255,0.30), rgba(255,255,255,0)),
            conic-gradient(from 0deg at 18px 50%,
                transparent 0 12deg, rgba(255,255,255,0.18) 12deg 12.8deg, transparent 12.8deg 24deg,
                rgba(255,255,255,0.16) 24deg 24.8deg, transparent 24.8deg 36deg,
                rgba(255,255,255,0.14) 36deg 36.8deg, transparent 36.8deg 180deg,
                transparent 180deg 332deg, rgba(255,255,255,0.12) 332deg 332.8deg, transparent 332.8deg 344deg,
                rgba(255,255,255,0.12) 344deg 344.8deg, transparent 344.8deg 360deg
            ),
            radial-gradient(circle at 18px 50%, rgba(253,230,138,0.55) 0%, rgba(253,230,138,0.0) 65%),
            linear-gradient(60deg, var(--sun-primary), var(--sun-secondary));
    }
    
    /* ===== SIDEBAR ===== */
    #sidebar { 
        display: none !important; 
    }
    #sidebar.show { 
        display: block !important; 
        position: fixed !important; 
        bottom: 0 !important; 
        left: 0 !important; 
        right: 0 !important; 
        max-height: 70vh !important; 
        z-index: 1000 !important; 
        background: var(--surface-0) !important; 
        border-top: 1px solid var(--border-1) !important; 
        box-shadow: var(--shadow-2) !important; 
        position: fixed; 
        bottom: 0; 
        left: 0; 
        right: 0; 
        width: 100%; 
        max-height: 70vh; 
        background: var(--surface-0); 
        border-top: 2px solid var(--border-1); 
        border-left: none; 
        z-index: 1000; 
        transform: translateY(100%); 
        transition: transform 0.3s ease; 
        overflow-y: auto; 
    }
    #sidebar.show { 
        transform: translateY(0); 
    }
    
    /* ===== MAP ===== */
    #map-container { 
        flex: 1; 
        width: 100%; 
        height: 100%; 
        min-height: 0; 
        position: relative; 
        display: block; 
    }
    #map { 
        width: 100% !important; 
        height: 100% !important; 
        min-height: 320px; 
        display: block !important; 
    }
    #map-container.sidebar-open { 
        height: 50vh; 
    }
    
    /* ===== MOBILE TOGGLES ===== */
    .mobile-sidebar-toggle, 
    .mobile-legend-toggle, 
    .mobile-filters-toggle { 
        display: inline-flex !important; 
        position: absolute !important;
        top: 5px !important;
        left: auto !important;
        right: auto !important;
        bottom: auto !important;
        width: 35px !important;
        height: 45px !important;
        min-height: 28px !important;
        padding: 0 !important;
        border-radius: 14px !important;
        justify-content: center !important;
        align-items: center !important;
        gap: 0 !important;
        z-index: 6001 !important;
        background-color: var(--surface-0) !important;
        border: 1px solid var(--border-1) !important;
        border-radius: var(--radius-2) !important;
        box-shadow: var(--shadow-1) !important;
        -webkit-tap-highlight-color: transparent;
        outline: none;
        transition: all var(--transition-fast) var(--easing) !important;
    }
    .mobile-legend-toggle { 
        right: 162px !important; 
    }
    .mobile-filters-toggle { 
        right: 121px !important; 
    }
    .mobile-sidebar-toggle { 
        right: 80px !important; 
    }
    .mobile-legend-toggle .toggle-text,
    .mobile-filters-toggle .toggle-text,
    .mobile-sidebar-toggle .toggle-text { 
        display: none !important; 
    }
    .mobile-legend-toggle .toggle-icon,
    .mobile-filters-toggle .toggle-icon,
    .mobile-sidebar-toggle .toggle-icon { 
        font-size: 0.9rem !important; 
    }
    .mobile-legend-toggle svg,
    .mobile-filters-toggle svg,
    .mobile-sidebar-toggle svg { 
        width: 18px; 
        height: 18px; 
        display: block; 
        fill: currentColor; 
    }
    .mobile-legend-toggle.active,
    .mobile-filters-toggle.active,
    .mobile-sidebar-toggle.active {
        background-color: var(--accent-600) !important;
        border-color: var(--accent-600) !important;
        color: var(--text-on-accent) !important;
    }
    .mobile-legend-toggle.active .toggle-text,
    .mobile-filters-toggle.active .toggle-text,
    .mobile-sidebar-toggle.active .toggle-text { 
        color: var(--text-on-accent) !important; 
    }
    :root[data-theme='dark'] .mobile-legend-toggle,
    :root[data-theme='dark'] .mobile-filters-toggle,
    :root[data-theme='dark'] .mobile-sidebar-toggle {
        box-shadow: 0 2px 10px rgba(0,0,0,0.45), 0 0 10px rgba(96, 165, 250, 0.18) !important;
        border-color: var(--border-2) !important;
    }
    .mobile-legend-toggle:hover,
    .mobile-legend-toggle:focus-visible,
    .mobile-filters-toggle:hover,
    .mobile-filters-toggle:focus-visible,
    .mobile-sidebar-toggle:hover,
    .mobile-sidebar-toggle:focus-visible {
        box-shadow: var(--shadow-2) !important;
        transform: translateY(-1px) !important;
        outline: none !important;
    }
    
    /* ===== STATISTICS ===== */
    .stat-grid { 
        grid-template-columns: 1fr; 
        gap: 8px; 
    }
    .stat-item { 
        padding: 12px; 
    }
    .stat-value { 
        font-size: 1.3rem; 
    }
    .stat-label { 
        font-size: 0.75rem; 
    }
    
    /* ===== LEGEND ===== */
    #map-legend { 
        position: fixed; 
        bottom: 10px; 
        left: 10px; 
        right: 10px; 
        padding: 10px; 
        max-height: 30vh; 
        overflow-y: auto; 
    }
    #map-legend h3 { 
        font-size: 1rem; 
        margin-bottom: 10px; 
    }
    .legend-section h4 { 
        font-size: 0.85rem; 
        margin-bottom: 6px; 
    }
    .legend-item { 
        font-size: 0.75rem; 
        gap: 6px; 
    }
    .legend-circle { 
        width: 10px; 
        height: 10px; 
    }
    
    /* ===== TABLE ===== */
    .table-container { 
        overflow-x: auto; 
        -webkit-overflow-scrolling: touch; 
    }
    #earthquake-table { 
        font-size: 0.7rem; 
        min-width: 100%; 
        width: 100%; 
        table-layout: fixed; 
    }
    #earthquake-table th:nth-child(1), 
    #earthquake-table td:nth-child(1) { 
        width: 25%; 
        padding: 6px 3px; 
        font-size: 0.65rem; 
    }
    #earthquake-table th:nth-child(2), 
    #earthquake-table td:nth-child(2) { 
        width: 15%; 
        padding: 6px 3px; 
        text-align: center; 
    }
    #earthquake-table th:nth-child(3), 
    #earthquake-table td:nth-child(3) { 
        width: 15%; 
        padding: 6px 3px; 
        text-align: center; 
    }
    #earthquake-table th:nth-child(4), 
    #earthquake-table td:nth-child(4) { 
        width: 10%; 
        padding: 6px 2px; 
        text-align: center; 
        font-size: 0.6rem; 
    }
    #earthquake-table th:nth-child(5), 
    #earthquake-table td:nth-child(5) { 
        width: 35%; 
        padding: 6px 3px; 
        font-size: 0.65rem; 
        overflow: hidden; 
        text-overflow: ellipsis; 
        white-space: nowrap; 
    }
    #data-table-panel { 
        padding: 15px; 
    }
    #data-table-panel h3 { 
        font-size: 1rem; 
        margin-bottom: 10px; 
    }
    .pagination-controls { 
        flex-wrap: wrap; 
        gap: 5px; 
        justify-content: center; 
    }
    .page-number { 
        min-width: 36px; 
        height: 36px; 
        font-size: 0.8rem; 
    }
    .pagination-info { 
        width: 100%; 
        text-align: center; 
        margin-bottom: 10px; 
        font-size: 0.75rem; 
    }
    
    /* ===== SIDEBAR COMPONENT OVERRIDES ===== */
    .mag-badge { 
        min-width: 24px; 
        height: 24px; 
        font-size: 0.8rem; 
        padding: 0 6px; 
    }
    
    /* ===== LOADING ===== */
    .loading-overlay { 
        backdrop-filter: blur(2px); 
    }
    .loading-spinner { 
        width: 40px; 
        height: 40px; 
    }
    
    /* ===== MISC ===== */
    #magnitude-range-container {
        margin: 0px 0 0px 0;
    }
}

/* ===== SMALL MOBILE STYLES (520px and below) ===== */

@media (max-width: 520px) {
    /* ===== EVENT CARDS ===== */
    .event-header { 
        align-items: center; 
        justify-content: space-between; 
        flex-direction: row; 
    }
    .event-time { 
        min-width: auto; 
        text-align: right; 
        align-items: flex-end; 
    }
    .event-details { 
        grid-template-columns: minmax(60px, auto) 1fr auto; 
        column-gap: 6px; 
    }
    .event-card { 
        padding: 10px 12px; 
    }
    .event-magnitude .mag-badge { 
        min-width: 30px; 
        height: 30px; 
        font-size: 0.85rem; 
        padding: 0 8px; 
    }
    #earthquake-table th { 
        padding: 10px 6px; 
        white-space: nowrap; 
        overflow: hidden; 
        text-overflow: ellipsis; 
    }
}

/* ===== FILTER HEADER MOBILE STYLES (640px and below) ===== */

@media (max-width: 640px) {
    .control-btn { 
        padding: 10px 12px; 
        min-width: 44px; 
        justify-content: center; 
    }
    .control-btn .btn-text { 
        display: none; 
    }
    .control-btn::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: -35px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(17,24,39,0.9);
        color: var(--pure-white);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease;
        z-index: 1200;
    }
    .control-btn:hover::after { 
        opacity: 1; 
    }
}

/* ===== VERY SMALL MOBILE (320px and below) ===== */

@media (max-width: 320px) {
    #filters-panel h1 { 
        font-size: 1.1rem; 
    }
    .last-updated { 
        font-size: 0.7rem; 
    }
    #map-container { 
        height: 45vh; 
        min-height: 250px; 
    }
    #sidebar { 
        max-height: 60vh; 
    }
    .mobile-sidebar-toggle { 
        bottom: 15px; 
        right: 15px; 
        padding: 10px 14px; 
    }
    .toggle-icon { 
        font-size: 1rem; 
    }
    .toggle-text { 
        font-size: 0.75rem; 
    }
    .stat-value { 
        font-size: 1.2rem; 
    }
    #earthquake-table { 
        font-size: 0.7rem; 
    }
    .page-number { 
        min-width: 32px; 
        height: 32px; 
        font-size: 0.75rem; 
    }
}

/* ===== ULTRA-SMALL LAYOUT (360px and below) ===== */

@media (max-width: 360px) {
    header { 
        min-height: 72px !important; 
    }
    .header-actions { 
        top: 8px !important; 
        right: 8px !important; 
    }
    .mobile-legend-toggle { 
        top: 8px !important; 
        right: 130px !important; 
        left: auto !important; 
    }
    .mobile-filters-toggle { 
        top: 8px !important; 
        right: 94px !important; 
        left: auto !important; 
    }
    .mobile-sidebar-toggle { 
        top: 40px !important; 
        right: 130px !important; 
        left: auto !important; 
    }
}

/* ===== GLOBAL OVERRIDES ===== */

/* Keep credits aligned left at all sizes */
.last-updated { 
    justify-content: flex-start !important; 
}
