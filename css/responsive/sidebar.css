/* ===== SIDEBAR RESPONSIVE STYLES ===== */

/* ===== MOBILE TAB PANEL OPTIMIZATIONS ===== */
/* Consolidated mobile styles for sidebar components */

/* ===== DESKTOP SIDEBAR COLLAPSED STATE ===== */
/* Desktop sidebar collapsed state (toggled by header Data button) */
@media (min-width: 769px) {
    #sidebar {
        /* Dynamic width that can collapse */
        width: 450px;
        /* Smooth transitions for better UX */
        transition: transform var(--animation-duration-slow) var(--animation-easing),
                    opacity var(--animation-duration-slow) var(--animation-easing),
                    border-color var(--animation-duration-slow) var(--animation-easing),
                    width var(--animation-duration-slow) var(--animation-easing);
        /* Performance optimizations */
        will-change: transform, opacity, width;
        transform: translateZ(0);
        contain: layout style paint;
    }
    #sidebar.collapsed {
        /* Collapse width to 0 to allow map to expand */
        width: 0 !important;
        min-width: 0 !important;
        transform: translateX(100%);
        opacity: 0;
        border-left-color: transparent !important;
        overflow: hidden !important;
        /* Stay in normal document flow to prevent layout shifts */
        position: relative !important;
        z-index: 1000 !important;
    }
    
    /* Force hide all date filter elements when sidebar is collapsed to prevent ghosting */
    #sidebar.collapsed .date-filter-card .collapsible,
    #sidebar.collapsed .date-filter-card .relative-options,
    #sidebar.collapsed .date-filter-card .year-slider-container,
    #sidebar.collapsed .date-filter-card .date-summary {
        opacity: 0 !important;
        visibility: hidden !important;
        transform: scale(0.95) !important;
        transition: none !important;
    }
    
    /* No transitions - instant changes for zero flicker */
    #map-container {
        /* Performance optimizations */
        will-change: flex-basis;
        transform: translateZ(0);
    }
    
    /* Enhanced button state transitions - immediate response */
    #header-data-toggle {
        transition: background-color var(--animation-duration-fast) var(--animation-easing),
                    border-color var(--animation-duration-fast) var(--animation-easing),
                    color var(--animation-duration-fast) var(--animation-easing),
                    box-shadow var(--animation-duration-fast) var(--animation-easing);
    }
    
}

/* ===== TABLET STYLES (768px and below) ===== */
@media (max-width: 768px) {
    /* ===== MOBILE TAB PANEL OPTIMIZATIONS ===== */
    #sidebar sl-tab-panel::part(base) {
        /* Mobile performance optimizations */
        will-change: transform, opacity;
        /* Ensure smooth height transitions */
        transition: opacity var(--mobile-animation-duration-normal) var(--animation-easing-smooth),
                    transform var(--mobile-animation-duration-normal) var(--animation-easing-smooth),
                    height var(--mobile-animation-duration-normal) var(--animation-easing-smooth);
    }
    
    /* Mobile slide transitions */
    #sidebar sl-tab-panel.tab-panel-slide-out::part(base) {
        transform: translateX(-100%);
    }
    
    #sidebar sl-tab-panel.tab-panel-slide-in::part(base) {
        transform: translateX(0);
    }
    
    /* ===== TABLE ===== */
    #earthquake-table { 
        font-size: 0.8rem; 
    }
    #earthquake-table th, 
    #earthquake-table td { 
        padding: 8px 6px; 
    }
    
    /* ===== TABLE SORT CONTROLS ===== */
    .table-sort-controls {
        display: flex;
        align-items: center;
        gap: clamp(1px, 1vw, 4px);
        flex-wrap: nowrap;
        margin-bottom: 12px;
        padding: 0 clamp(2px, 2vw, 8px);
        overflow: visible;
    }
    
    .sortable {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex: 1 1 auto;
        font-size: clamp(0.6rem, 2.5vw, 0.8rem);
        min-width: 0;
        white-space: nowrap;
    }
    
    .sort-indicator {
        width: clamp(10px, 2.5vw, 14px);
        height: clamp(10px, 2.5vw, 14px);
        margin-left: clamp(1px, 1vw, 4px);
        flex-shrink: 0;
    }
}

/* ===== SMALL MOBILE STYLES (480px and below) ===== */
@media (max-width: 480px) {
    /* ===== SIDEBAR ===== */
    #sidebar { 
        display: block !important; 
        transform: translateY(100%) !important;
        width: 100% !important;
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        height: 50vh !important;
        z-index: 1000 !important;
        background: var(--surface-0) !important;
        border-top: 2px solid var(--border-1) !important;
        border-left: none !important;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15) !important;
        overflow-y: auto !important;
        transition: transform var(--mobile-animation-duration-fast) var(--animation-easing) !important;
        /* Ensure smooth animations by keeping element in DOM */
        visibility: visible !important;
        /* Performance optimizations for touch gestures */
        will-change: transform;
        touch-action: pan-y;
    }
    
    /* Force hide all date filter elements when sidebar is sliding down to prevent ghosting */
    #sidebar:not(.show) .date-filter-card .collapsible,
    #sidebar:not(.show) .date-filter-card .relative-options,
    #sidebar:not(.show) .date-filter-card .year-slider-container,
    #sidebar:not(.show) .date-filter-card .date-summary {
        opacity: 0 !important;
        visibility: hidden !important;
        transform: scale(0.95) !important;
        transition: none !important;
    }
    #sidebar.show { 
        transform: translateY(0) !important; 
    }
    
    /* Enhanced mobile tab animations */
    #sidebar sl-tab-group::part(nav) {
        background: var(--surface-0);
        border-bottom: 1px solid var(--border-1);
        /* Smooth mobile tab transitions */
        transition: background-color var(--animation-duration-normal) var(--animation-easing);
    }
    
    #sidebar sl-tab::part(base) {
        /* Enhanced mobile tab button animations */
            transition: color var(--animation-duration-fast) var(--animation-easing),
                background-color var(--animation-duration-fast) var(--animation-easing);
    }
    
    /* Mobile tab panel animations - Override Shoelace defaults */
    #sidebar sl-tab-panel::part(base) {
        /* Override Shoelace's display: none behavior */
        display: block !important;
        opacity: 1;
        transform: translateY(0);
            transition: opacity var(--animation-duration-normal) var(--animation-easing),
                transform var(--animation-duration-normal) var(--animation-easing);
        pointer-events: auto;
    }
    
    /* Hide inactive panels with smooth animation */
    #sidebar sl-tab-panel:not([active])::part(base) {
        opacity: 0;
        transform: translateY(8px);
        pointer-events: none;
        /* Keep display: block but make it invisible */
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        z-index: -1;
    }
    
    /* Active panel should be visible and positioned normally */
    #sidebar sl-tab-panel[active]::part(base) {
        position: relative;
        z-index: 1;
    }
    
    /* ===== TABLE ===== */
    .table-container { 
        overflow-x: auto; 
        -webkit-overflow-scrolling: touch; 
    }
    #earthquake-table { 
        font-size: 0.7rem; 
        min-width: 100%; 
        width: 100%; 
        table-layout: fixed; 
    }
    #earthquake-table th:nth-child(1), 
    #earthquake-table td:nth-child(1) { 
        width: 25%; 
        font-size: 0.65rem; 
    }
    #earthquake-table th:nth-child(2), 
    #earthquake-table td:nth-child(2) { 
        width: 15%; 
        padding: 6px 3px; 
        text-align: center; 
    }
    #earthquake-table th:nth-child(3), 
    #earthquake-table td:nth-child(3) { 
        width: 15%; 
        padding: 6px 3px; 
        text-align: center; 
    }
    #earthquake-table th:nth-child(4), 
    #earthquake-table td:nth-child(4) { 
        width: 10%; 
        padding: 6px 2px; 
        text-align: center; 
        font-size: 0.6rem; 
    }
    #earthquake-table th:nth-child(5), 
    #earthquake-table td:nth-child(5) { 
        width: 35%; 
        padding: 6px 3px; 
        font-size: 0.65rem; 
        overflow: hidden; 
        text-overflow: ellipsis; 
        white-space: nowrap; 
    }
    #data-table-panel { 
        padding: 15px; 
    }
    #data-table-panel h3 { 
        font-size: 1rem; 
        margin-bottom: 10px; 
    }
    .pagination-controls { 
        flex-wrap: wrap; 
        gap: 5px; 
        justify-content: center; 
    }
    .page-number { 
        min-width: 36px; 
        height: 36px; 
        font-size: 0.8rem; 
    }
    .pagination-info { 
        width: 100%; 
        text-align: center; 
        margin-bottom: 10px; 
        font-size: 0.75rem; 
    }
    
    /* ===== SIDEBAR COMPONENT OVERRIDES ===== */
    
    /* Mobile row animations - using utility classes */
    
    /* ===== TABLE ANIMATIONS ===== */
    /* Enhanced table animations for mobile */
    #data-table-panel {
        transition: opacity var(--animation-duration-normal) var(--animation-easing);
    }

    #data-table-panel.loading {
        opacity: 0.6;
    }

    /* Table row animations */
    .earthquake-row {
        transition: background-color var(--animation-duration-fast) var(--animation-easing),
                    transform var(--animation-duration-fast) var(--animation-easing),
                    box-shadow var(--animation-duration-fast) var(--animation-easing);
        /* Performance optimizations */
        will-change: transform, background-color, box-shadow;
        contain: layout style paint;
        content-visibility: auto;
        contain-intrinsic-size: 0 60px;
    }

    .earthquake-row:hover {
        transform: translateY(-1px);
    }

    .earthquake-row.highlighted {
        background-color: var(--highlight-bg);
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
        transform: translateY(-1px);
    }

    /* ===== PAGINATION ANIMATIONS ===== */
    .pagination-controls {
        transition: opacity var(--animation-duration-fast) var(--animation-easing);
    }

    .pagination-controls.loading {
        opacity: 0.6;
        pointer-events: none;
    }
}

/* ===== SMALL MOBILE STYLES (520px and below) ===== */
@media (max-width: 520px) {
    /* ===== EVENT CARDS ===== */
    .event-header { 
        align-items: center; 
        justify-content: space-between; 
        flex-direction: row; 
    }
    .event-time { 
        min-width: auto; 
        text-align: right; 
        align-items: flex-end; 
    }
    .event-details { 
        grid-template-columns: minmax(60px, auto) 1fr auto; 
        column-gap: 6px; 
    }
    .event-card { 
        padding: 10px 12px; 
    }

    #earthquake-table th { 
        padding: 10px 6px; 
        white-space: nowrap; 
        overflow: hidden; 
        text-overflow: ellipsis; 
    }
}

/* ===== VERY SMALL MOBILE (320px and below) ===== */
@media (max-width: 320px) {
    #earthquake-table { 
        font-size: 0.7rem; 
    }
    .page-number { 
        min-width: 32px; 
        height: 32px; 
        font-size: 0.75rem; 
    }
    
    /* Horizontal scroll fallback for sort controls on extremely small screens */
    .table-sort-controls {
        overflow-x: auto;
        overflow-y: hidden;
        padding: 0 clamp(1px, 1vw, 2px);
        gap: clamp(1px, 0.5vw, 2px);
        justify-content: flex-start;
        -webkit-overflow-scrolling: touch;
    }
    
    .sortable {
        font-size: clamp(0.55rem, 2vw, 0.7rem);
        min-width: 0;
        flex: 0 0 auto;
        white-space: nowrap;
    }
    
    .sort-indicator {
        width: clamp(8px, 2vw, 12px);
        height: clamp(8px, 2vw, 12px);
        margin-left: clamp(1px, 0.5vw, 2px);
    }
}

/* ===== TABLE SORT CONTROLS RESPONSIVE ===== */
/* Now handled by fluid responsive design with clamp() in main 768px media query */

/* ===== STATISTICS RESPONSIVE STYLES ===== */
/* ===== TABLET STYLES (768px and below) ===== */
@media (max-width: 768px) {
    .stat-grid {
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }
    
    .stat-item {
        padding: 12px;
    }
    
    .stat-value {
        font-size: 1.5rem;
    }
    
    .stat-label {
        font-size: 0.8rem;
    }
}

/* ===== MOBILE STYLES (480px and below) ===== */
@media (max-width: 480px) {
    .stat-grid {
        grid-template-columns: 1fr 1fr;
        gap: 6px;
    }
    
    .stat-item {
        padding: 8px;
    }
    
    .stat-value {
        font-size: 1.2rem;
    }
    
    .stat-label {
        font-size: 0.7rem;
    }
}
